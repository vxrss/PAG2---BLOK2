<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="utf-8">
<title>Mapa</title>

<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet/dist/leaflet.css"
/>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
html, body, #map {
  height: 100%;
  margin: 0;
}
</style>
</head>

<body>
<div id="map"></div>

<script>

const map = L.map("map").setView([53.0138, 18.5984], 12);

L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
  attribution: "Â© OpenStreetMap"
}).addTo(map);


let clicks = [];
let markers = [];

map.on("click", e => {
  clicks.push(e.latlng);
  markers.push(L.marker(e.latlng).addTo(map));

  if (clicks.length === 2) {
    const a = clicks[0];
    const b = clicks[1];

    window.location.href =
      `route://?sy=${a.lat}&sx=${a.lng}&ey=${b.lat}&ex=${b.lng}`;

    clicks = [];
    markers.forEach(m => map.removeLayer(m));
    markers = [];
  }
});


let routes = [];


function clearRoutes() {
  routes.forEach(r => map.removeLayer(r));
  routes = [];
}


function drawRoute(coords, color) {
  const line = L.polyline(coords, {
    color: color,
    weight: 5,
    opacity: 0.85
  }).addTo(map);

  routes.push(line);


  if (routes.length === 1) {
    map.fitBounds(line.getBounds());
  }
}
</script>
</body>
</html>
